<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>SplayNet v0</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <script language="JavaScript1.2" type="text/javascript">

    function fillIn(){
        if (document.cookie != ""){
            cookies = document.cookie.split(";");
            for (var i = 0; i < cookies.length; i++) {
                cookie = cookies[i].trim().split("=");
                if (cookie[0] == 'BGA_LOGIN') {
                    quoted_value = cookie[1];
                    document.login_info.BGA_LOGIN.value = quoted_value.replace(/^"|"$/g, '');
                }
                if (cookie[0] == 'BGA_PASSWORD') {
                    document.login_info.BGA_PASSWORD.value = cookie[1];
                }
                if (cookie[0] == 'BGA_NAME') {
                    document.login_info.BGA_NAME.value = cookie[1];
                }
                if (cookie[0] == 'TABLE_ID') {
                    document.login_info.TABLE_ID.value = cookie[1];
                }
                if (cookie[0] == 'card_1') {
                    document.login_info.card_1.value = cookie[1];
                }
                if (cookie[0] == 'card_2') {
                    document.login_info.card_2.value = cookie[1];
                }
            }
        }
    }

    function reveal() {

      var pwd = document.getElementsByName("BGA_PASSWORD")[0];

      if (pwd.type === 'password') {
        pwd.type = 'text';
      } else {
         pwd.type = 'password';
      }

    }

    </script>
</head>
<body onload="fillIn()">
<div class="container-sm" style="max-width: 540px;">
    <div class="mb-3">
        <h1>Splaynet</h1>
        <label>All of your bases are belong to us. </label>
        <a href="https://github.com/cmilando/splaynet">GitHub</a>
    </div>
    <form action="{{ url_for('index') }}" method="POST" name="login_info">
        <div class="mb-1">
            <input type="text" name="BGA_LOGIN" placeholder="BGA login email" class="form-control">
        </div>
        <div class="input-group mb-1">
            <input type="password" name="BGA_PASSWORD" placeholder="BGA password" class="form-control">
            <button class="btn btn-outline-secondary" type="button" id="button-addon2" onclick="reveal()">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-eye">
  <path d="M16 8s-3-5.5-8-5.5S0 8 0 8s3 5.5 8 5.5S16 8 16 8zM1.173 8a13.133 13.133 0 0 1 1.66-2.043C4.12 4.668 5.88 3.5 8 3.5c2.12 0 3.879 1.168 5.168 2.457A13.133 13.133 0 0 1 14.828 8c-.058.087-.122.183-.195.288-.335.48-.83 1.12-1.465 1.755C11.879 11.332 10.119 12.5 8 12.5c-2.12 0-3.879-1.168-5.168-2.457A13.134 13.134 0 0 1 1.172 8z"/>
  <path d="M8 5.5a2.5 2.5 0 1 0 0 5 2.5 2.5 0 0 0 0-5zM4.5 8a3.5 3.5 0 1 1 7 0 3.5 3.5 0 0 1-7 0z"/>
</svg>
            </button>
        </div>
        <div class="mb-1">
            <input type="text" name="BGA_NAME" placeholder="BGA handle (e.g., Jeffpacito)" class="form-control">
        </div>
        <div class="mb-1">
            <input type="text" name="TABLE_ID" placeholder="Table ID" class="form-control">
        </div>
        <div class="mb-1">
            <input list="age_1_cards" name="card_1" placeholder="Starting card 1" class="form-control">
        </div>
        <div class="mb-3">
            <input list="age_1_cards" name="card_2" placeholder="Starting card 2" class="form-control">
        </div>
        <datalist id="age_1_cards">
            <option value="Agriculture">
            <option value="Archery">
            <option value="City_States">
            <option value="Clothing">
            <option value="Code_of_Laws">
            <option value="Domestication">
            <option value="Masonry">
            <option value="Metalworking">
            <option value="Mysticism">
            <option value="Oars">
            <option value="Pottery">
            <option value="Sailing">
            <option value="Tools">
            <option value="The_Wheel">
            <option value="Writing">
        </datalist>
        <div class="mb-3">
            <input type="submit" name="refresh" value="Refresh" class="btn btn-primary">
        </div>
    </form>
</div>


<div class="container-sm" style="max-width: 540px;">

    {% if result %}

        <div class="accordion" id="accordionExample">
            {% for game_state in result %}
                {% set outer_loop = loop %}
                <div class="accordion-item">
                    <!-- HEADER -->
                    <h2 class="accordion-header" id="heading_{{ outer_loop.index }}">
                       <button class="accordion-button" type="button" data-bs-toggle="collapse" data-bs-target="#collapse_{{ outer_loop.index }}"
                               aria-expanded="true" aria-controls="collapse_{{ outer_loop.index }}">
                           {% for key, value in game_state.items() %}
                               {{ key }}
                           {% endfor %}
                       </button>
                    </h2>
                    <!-- FIRST DROP DOWN -->
                    <div id="collapse_{{ outer_loop.index }}" class="accordion-collapse collapse" aria-labelledby="heading_{{ outer_loop.index }}" data-bs-parent="#accordionExample">
                        <div class="accordion-body">
                            {% for key, sub_cards in game_state.items() %}
                                <!-- SECOND ACCORDIAN -->

                                {% if sub_cards %}
                                    <div class="accordion" id="subaccordion{{ outer_loop.index}}">
                                        {% for card in sub_cards %}
                                            {% set card_loop = loop %}

                                            <div class="accordion-item">
                                                <!-- SECOND HEADER -->
                                                <h2 class="accordion-header" id="heading_{{ outer_loop.index }}_{{ card_loop.index }}">
                                                   <button class="accordion-button" type="button" data-bs-toggle="collapse"
                                                           data-bs-target="#collapse_{{ outer_loop.index }}_{{ card_loop.index }}"
                                                           aria-expanded="true"
                                                           aria-controls="collapse_{{ outer_loop.index }}_{{ card_loop.index }}">
                                                       {% for key, value in card.items() %}
                                                           {{ key }}
                                                       {% endfor %}

                                                   </button>
                                                </h2>

                                                <div id="collapse_{{ outer_loop.index }}_{{ card_loop.index }}" class="accordion-collapse collapse"
                                                     aria-labelledby="heading_{{ outer_loop.index }}_{{ card_loop.index }}" data-bs-parent="#subaccordion{{ outer_loop.index}}">
                                                    <div class="accordion-body">

                                                       {% for key, value_dict in card.items() %}
                                                            <!-- and now what, make a table? -->
                                                            {% for pval, value_list in value_dict.items() %}
                                                                There is a <strong>{{ pval }}</strong> chance this card is:
                                                                <ul>
                                                                    {% for value in value_list %}
                                                                        <li>{{ value }}</li>
                                                                    {% endfor %}
                                                                </ul>

                                                            {% endfor %}
                                                       {% endfor %}

                                                    </div>
                                                </div>

                                            </div> <!-- second accordian cards -->
                                        {% endfor %}
                                    </div> <!-- second accordian -->

                                {% endif %}

                           {% endfor %}
                        </div>
                    </div>
                </div>
            {% endfor %}
        </div>

    {% endif %}

</div>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
</body>
</html>
